# Avito User Interaction Pipeline: –û—Ç –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥ –¥–æ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫

[![Python 3.10](https://img.shields.io/badge/Python-3.10-3776AB?logo=python)](https://python.org)
[![Spark 3.5.1](https://img.shields.io/badge/Spark-3.5.1-E25A1C?logo=apachespark)](https://spark.apache.org)
[![Airflow 2.9.3](https://img.shields.io/badge/Airflow-2.9.3-017CEE?logo=apacheairflow)](https://airflow.apache.org)
[![Superset 4.0+](https://img.shields.io/badge/Superset-4.0+-F0B90B?logo=apachesuperset)](https://superset.apache.org)
[![PostgreSQL 15](https://img.shields.io/badge/PostgreSQL-15-336791?logo=postgresql)](https://postgresql.org)
[![MinIO S3](https://img.shields.io/badge/MinIO-S3-222222?logo=minio)](https://min.io)

## üìå –û –ø—Ä–æ–µ–∫—Ç–µ

–ó–∞–∫–∞–∑—á–∏–∫ (–≤–æ–æ–±—Ä–∞–∂–∞–µ–º—ã–π) –ø–æ—Å—Ç–∞–≤–∏–ª –∑–∞–¥–∞—á—É: —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Avito, –ø–æ–Ω—è—Ç—å, –∫—Ç–æ –∏ –∫–∞–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π, –∏ –¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –ù–∞ —Ä—É–∫–∞—Ö ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è AvitoTech ML Cup 2025: 68 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–∫—Å—Ç—Ä–∏–º–∞, —Å–æ–±—ã—Ç–∏—è, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤. –í—Å—ë —ç—Ç–æ –ª–µ–∂–∏—Ç –≤ S3 (MinIO).

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –ü–æ—Å—Ç—Ä–æ–µ–Ω **–Ω–∞–¥—ë–∂–Ω—ã–π ETL-–ø–∞–π–ø–ª–∞–π–Ω** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Apache Spark.
- –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã **—Å–ª–æ–∏ –¥–∞–Ω–Ω—ã—Ö** (core ‚Üí marts) –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –≤–∏—Ç—Ä–∏–Ω**, –æ–±–Ω–æ–≤–ª—è—é—â–∏–π—Å—è –∫–∞–∂–¥—É—é –Ω–æ—á—å —á–µ—Ä–µ–∑ Airflow.
- –°–æ–∑–¥–∞–Ω—ã **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –≤ Superset**, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏.

**–ö–ª—é—á–µ–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –±–∏–∑–Ω–µ—Å –ø–æ–ª—É—á–∏–ª –ø—Ä–æ–∑—Ä–∞—á–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π, –∫–∞–∫–∏–µ —Å–µ–≥–º–µ–Ω—Ç—ã –Ω–∞–∏–±–æ–ª–µ–µ —Ü–µ–Ω–Ω—ã, –∏ –≥–¥–µ —Å–∫—Ä—ã—Ç—ã —Ç–æ—á–∫–∏ —Ä–æ—Å—Ç–∞.

## üìä –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|-----------|
| –û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö | 68.8+ –º–ª–Ω —Å—Ç—Ä–æ–∫ –≤ –≤–∏—Ç—Ä–∏–Ω–∞—Ö |
| –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ | 10 –º–∏–Ω—É—Ç –Ω–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –ø–∞—Ä—Ç–∏—Ü–∏—é |
| –í–∏—Ç—Ä–∏–Ω—ã | 3 –≥–æ—Ç–æ–≤—ã—Ö –∫ –¥—Ä—ç–≥-–Ω-–¥—Ä–æ–ø  |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ | 12 –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ä—Ç–æ–≤ |
| –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | –ù–µ—Ç –æ—à–∏–±–æ–∫ OOM –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ 100+ –º–ª–Ω —Å—Ç—Ä–æ–∫ |
| –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å | –ü–æ–ª–Ω–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö |

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   üì¶ MinIO   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  üî• Spark    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ üêò PostgreSQL   ‚îÇ‚îÄ‚ñ∂     ‚îÇ üìà Superset ‚îÇ
‚îÇ  (S3 raw)    ‚îÇ      ‚îÇ  (Jupyter)   ‚îÇ       ‚îÇ  (core + marts)  ‚îÇ       ‚îÇ  (–¥–∞—à–±–æ—Ä–¥—ã)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ                       ‚ñ≤
                           ‚îÇ                       ‚îÇ
                           ‚ñº                       ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
                    ‚îÇ ‚è∞ Airflow  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ  (DAG)       ‚îÇ  –∑–∞–ø—É—Å–∫ –Ω–æ—É—Ç–±—É–∫–∞
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ingest_date
```

## üí° –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### 1. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö (—Ç–∏–ø `int64`). Spark –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `TIMESTAMP(NANOS,false)`:

```python
# –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥ ‚Üí —Å–µ–∫—É–Ω–¥—ã ‚Üí timestamp
df.withColumn("event_date", (col("event_date") / 1_000_000_000).cast("timestamp"))
```

### 2. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
–í–∏—Ç—Ä–∏–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –¥–Ω–∏, –∞ –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é:

```sql
-- –£–¥–∞–ª—è–µ–º –∞–≥—Ä–µ–≥–∞—Ç—ã –¢–û–õ–¨–ö–û –∑–∞ –¥–Ω–∏ –∏–∑ –Ω–æ–≤–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏
DELETE FROM marts.mart_daily_surface_stats 
WHERE event_day IN (
    SELECT DISTINCT DATE_TRUNC('day', event_date)::date 
    FROM core.fct_user_interactions 
    WHERE ingest_date = '2025-02-14'
);

-- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –í–°–ï–• —Ñ–∞–∫—Ç–æ–≤ –∑–∞ —ç—Ç–∏ –¥–Ω–∏
INSERT INTO marts.mart_daily_surface_stats
SELECT 
    DATE_TRUNC('day', event_date)::date AS event_day,
    surface_id,
    platform_id,
    COUNT(*) AS total_interactions,
    COUNT(CASE WHEN is_contact THEN 1 END) AS contacts,
    ROUND(COUNT(CASE WHEN is_contact THEN 1 END) * 100.0 / COUNT(*), 2) AS contact_rate
FROM core.fct_user_interactions
WHERE DATE_TRUNC('day', event_date)::date IN ('2025-02-14')  -- –¢–æ–ª—å–∫–æ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –¥–Ω–∏
GROUP BY 1, 2, 3;
```

### 3. –í–∏—Ç—Ä–∏–Ω—ã –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤
–í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–∫–∞–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –≥–æ—Ç–æ–≤—ã –∫ –¥—Ä—ç–≥-–Ω-–¥—Ä–æ–ø –≤ –ª—é–±–æ–º BI:

| –í–∏—Ç—Ä–∏–Ω–∞ | –ö–æ–ª–æ–Ω–∫–∏ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|---------|---------|------------|
| `mart_user_interactions` | `cookie`, `item`, `event_day`, `surface_id`, `platform_id`, `is_contact` | –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ |
| `mart_daily_surface_stats` | `event_day`, `surface_id`, `platform_id`, `contact_rate`, `unique_users` | –¢—Ä–µ–Ω–¥—ã –∏ –∞–≥—Ä–µ–≥–∞—Ç—ã |
| `mart_user_behavior` | `cookie`, `lifetime_contact_rate`, `is_active_7d`, `contact_tier` | –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
avito-ml-cup-2025/
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îú‚îÄ‚îÄ avito_incremental_marts_dag.py   # –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏—Ç—Ä–∏–Ω
‚îÇ   ‚îî‚îÄ‚îÄ avito_load_dag.py                # –ó–∞–≥—Ä—É–∑–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îú‚îÄ‚îÄ avito_load.ipynb                 # ETL –≤ core-—Å–ª–æ–π
‚îÇ   ‚îî‚îÄ‚îÄ avito_incremental_marts.ipynb    # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏—Ç—Ä–∏–Ω
‚îú‚îÄ‚îÄ screenshots/
‚îÇ   ‚îú‚îÄ‚îÄ dashboard_overview.png           # –û–±–∑–æ—Ä–Ω—ã–π –¥–∞—à–±–æ—Ä–¥
‚îÇ   ‚îú‚îÄ‚îÄ dashboard_interactions.png       # –î–µ—Ç–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ dashboard_behavior.png           # –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ README.md
```

## üñºÔ∏è –î–∞—à–±–æ—Ä–¥—ã

### –û–±–∑–æ—Ä –º–µ—Ç—Ä–∏–∫
![–û–±–∑–æ—Ä –º–µ—Ç—Ä–∏–∫](screenshots/dashboard_overview.png)

- –î–∏–Ω–∞–º–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∑–∞ 30 –¥–Ω–µ–π
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º
- –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —á–∞—Å–∞–º

### –î–µ—Ç–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
![–î–µ—Ç–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è](screenshots/dashboard_interactions.png)

- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—è–º
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ –¥–Ω—è–º
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
![–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π](screenshots/dashboard_behavior.png)

- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ 7/30 –¥–Ω–µ–π
- –ü—Ä–∏—Ç–æ–∫ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º

## üîë –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö

- **60-70% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–º–µ—é—Ç 0% –∫–æ–Ω–≤–µ—Ä—Å–∏—é** ‚Äî –Ω–æ—Ä–º–∞ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- **5-10% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∫–æ–Ω–≤–µ—Ä—Å–∏–µ–π >5% –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç 70% –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤** ‚Äî —Ñ–æ–∫—É—Å –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–∏
- **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ç –≤ 2√ó –ª—É—á—à–µ –¥–µ—Å–∫—Ç–æ–ø–∞** ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å >30 –¥–Ω–µ–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é –≤ 3√ó** ‚Äî –ª–æ—è–ª—å–Ω–æ—Å—Ç—å = —Ä–æ—Å—Ç

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ GitHub

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É
mkdir avito-ml-cup-2025
cd avito-ml-cup-2025

# –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p dags notebooks screenshots
```

### –®–∞–≥ 2: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—á–∏–µ —Ñ–∞–π–ª—ã

```bash
# DAG'–∏ –∏–∑ –≤–∞—à–µ–π —Å—Ä–µ–¥—ã
cp /workspace/dags/avito_incremental_marts_dag.py dags/
cp /workspace/dags/avito_load_dag.py dags/

# –ù–æ—É—Ç–±—É–∫–∏ –∏–∑ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
cp /workspace/notebooks/module01_ingest/work/avito_load.ipynb notebooks/
cp /workspace/notebooks/module03_marts/work/avito_incremental_marts.ipynb notebooks/

# –°–¥–µ–ª–∞–π—Ç–µ 3 —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –¥–∞—à–±–æ—Ä–¥–æ–≤ –≤ Superset:
# 1. –û–±–∑–æ—Ä–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ screenshots/dashboard_overview.png
# 2. –í–∫–ª–∞–¥–∫–∞ "–î–µ—Ç–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è" ‚Üí screenshots/dashboard_interactions.png
# 3. –í–∫–ª–∞–¥–∫–∞ "–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π" ‚Üí screenshots/dashboard_behavior.png
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .gitignore

```bash
cat > .gitignore << 'EOF'
# –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
__pycache__/
*.pyc
*.ipynb_checkpoints
*.log

# –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
data/
datasets/
db/
EOF
```

### –®–∞–≥ 4: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ GitHub

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git
git init
git add .
git commit -m "Production-ready analytics pipeline for AvitoTech ML Cup 2025"

# –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub (https://github.com/new)
# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
git branch -M main
git remote add origin https://github.com/–≤–∞—à-–ª–æ–≥–∏–Ω/avito-ml-cup-2025.git
git push -u origin main
```

## üíº –ü–æ—á–µ–º—É —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –≤—ã–¥–µ–ª–∏—Ç—Å—è –≤ –æ—Ç–±–æ—Ä–µ

1. **–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Å—á–µ—Ç–∞
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ 68 –º–ª–Ω —Å—Ç—Ä–æ–∫ –±–µ–∑ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏
3. **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** ‚Äî –≤–∏—Ç—Ä–∏–Ω—ã –±–µ–∑ –º–∞—Å—Å–∏–≤–æ–≤, —Ç–æ–ª—å–∫–æ —Å–∫–∞–ª—è—Ä–Ω—ã–µ —Ç–∏–ø—ã
4. **–†–µ–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏** ‚Äî —Ñ–æ–∫—É—Å –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî –æ—Ç –∫–æ–¥–∞ –¥–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –¥–∞—à–±–æ—Ä–¥–æ–≤

> –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –Ω–æ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á. –í—Å–µ –¥–∞—à–±–æ—Ä–¥—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî –∫–ª—é—á–µ–≤–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ production-—Å—Ä–µ–¥—ã.




```markdown
# üî• AvitoTech User Interaction Pipeline: –û—Ç –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥ –¥–æ –±–∏–∑–Ω–µ—Å‚Äë–º–µ—Ç—Ä–∏–∫

**–ü—Ä–æ–µ–∫—Ç –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ AvitoTech –±—É—Ç–∫–µ–º–ø**  
*–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ end‚Äëto‚Äëend –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ML Cup 2025*

[![Python](https://img.shields.io/badge/Python-3.10-blue?logo=python)](https://python.org)
[![Spark](https://img.shields.io/badge/Spark-3.5.1-orange?logo=apachespark)](https://spark.apache.org)
[![Airflow](https://img.shields.io/badge/Airflow-2.9.3-green?logo=apacheairflow)](https://airflow.apache.org)
[![Superset](https://img.shields.io/badge/Superset-4.0+-yellow?logo=apachesuperset)](https://superset.apache.org)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-blue?logo=postgresql)](https://postgresql.org)
[![MinIO](https://img.shields.io/badge/MinIO-S3-red?logo=minio)](https://min.io)
[![Jupyter](https://img.shields.io/badge/Jupyter-Notebook-orange?logo=jupyter)](https://jupyter.org)

---



---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   üì¶ MinIO   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  üî• Spark    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  üêò PostgreSQL ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  üìà Superset  ‚îÇ
‚îÇ  (S3 raw)    ‚îÇ     ‚îÇ  (Jupyter)   ‚îÇ     ‚îÇ  (core + marts)‚îÇ     ‚îÇ  (–¥–∞—à–±–æ—Ä–¥—ã)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ                       ‚ñ≤
                           ‚îÇ                       ‚îÇ
                           ‚ñº                       ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
                    ‚îÇ  ‚è∞ Airflow  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ  (DAG)       ‚îÇ  –∑–∞–ø—É—Å–∫ –Ω–æ—É—Ç–±—É–∫–∞
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ingest_date
```

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–≤—è–∑–∞–Ω—ã –≤ –µ–¥–∏–Ω—É—é —Å–µ—Ç—å Docker, –Ω–æ –∫–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –ª—é–±–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ.

---

## üß† –ö–∞–∫ —ç—Ç–æ —É—Å—Ç—Ä–æ–µ–Ω–æ –≤–Ω—É—Ç—Ä–∏

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (core‚Äë—Å–ª–æ–π)

–ü–µ—Ä–≤–∞—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç—å: Parquet‚Äë—Ñ–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π Spark –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–Ω–∏–º–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é.  
**–†–µ—à–µ–Ω–∏–µ:** —á–∏—Ç–∞–µ–º –ø–æ–ª–µ `event_date` –∫–∞–∫ `LongType` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥), –∑–∞—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π timestamp:

```python
df.withColumn("event_date", (col("event_date") / 1_000_000_000).cast("timestamp"))
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–±–æ–≥–∞—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ:
- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º —Å–æ–±—ã—Ç–∏—è (—á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –±—ã–ª–æ –ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–º)
- –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –ª–æ–∫–∞—Ü–∏—é —Ç–æ–≤–∞—Ä–∞
- –§–∏–∫—Å–∏—Ä—É–µ–º –¥–∞—Ç—É –∑–∞–≥—Ä—É–∑–∫–∏ (`ingest_date`)

–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `core.fct_user_interactions` (68 –º–ª–Ω —Å—Ç—Ä–æ–∫ –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–∞—Å—á—ë—Ç–∞).

### 2. –í–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö (marts‚Äë—Å–ª–æ–π)

#### üìã `mart_user_interactions`
–î–µ—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å enrich‚Äë–ø–æ–ª—è–º–∏ –∏ —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –¥–Ω—è–º/–Ω–µ–¥–µ–ª—è–º/—á–∞—Å–∞–º ‚Äì –æ—Å–Ω–æ–≤–∞ –¥–ª—è ad‚Äëhoc –∑–∞–ø—Ä–æ—Å–æ–≤.

#### üìä `mart_daily_surface_stats`
–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã –≤ —Ä–∞–∑—Ä–µ–∑–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π, –ø–ª–∞—Ç—Ñ–æ—Ä–º, –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ª–æ–∫–∞—Ü–∏–π:
- –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
- —á–∏—Å–ª–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è
- —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ç–æ–≤–∞—Ä—ã

**–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ—Å—Ç—å:** –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–Ω–∏, –≤ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç—É–ø–∏–ª–∏ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

#### üë• `mart_user_behavior` ‚Äì –∫–ª—é—á–µ–≤–∞—è –≤–∏—Ç—Ä–∏–Ω–∞
–ü–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è:
- `first_seen_date`, `last_seen_date`
- `total_interactions`, `total_contacts`
- `lifetime_contact_rate` (–∫–æ–Ω–≤–µ—Ä—Å–∏—è)
- `activity_span_days` ‚Äì —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø—Ä–æ—à–ª–æ –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤–∏–∑–∏—Ç–æ–º
- `recent_platforms`, `recent_surfaces` ‚Äì –º–∞—Å—Å–∏–≤—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º/–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –∫–∞–Ω–∞–ª–æ–≤)

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ:** –º–∞—Å—Å–∏–≤—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –≤ Superset —á–µ—Ä–µ–∑ `unnest` —Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á—ë—Ç—ã –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º —Å—Ä–µ–¥–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### 3. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤ Airflow

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω DAG `avito_incremental_marts`, –∫–æ—Ç–æ—Ä—ã–π:
- –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 2:00 –Ω–æ—á–∏
- —á–µ—Ä–µ–∑ **papermill** –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–æ—É—Ç–±—É–∫ `02_build_marts.ipynb`
- –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ –Ω–æ—É—Ç–±—É–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä `ingest_date = {{ ds }}` (–ª–æ–≥–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Ä–∞–≤–Ω–∞—è –≤—á–µ—Ä–∞—à–Ω–µ–º—É –¥–Ω—é)

–ù–æ—É—Ç–±—É–∫ —á–∏—Ç–∞–µ—Ç –∏–∑ `core.fct_user_interactions` —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ —Å —ç—Ç–æ–π –¥–∞—Ç–æ–π –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤–∏—Ç—Ä–∏–Ω—ã. –ü–æ–ª–Ω–∞—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## üìä –î–∞—à–±–æ—Ä–¥—ã: –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è

### –≠–∫—Ä–∞–Ω 1: –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±–∑–æ—Ä
![Overview](images/overview.png)  
*–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º —ç–∫—Ä–∞–Ω–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å—Ä–µ–¥–Ω—è—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è, —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ì—Ä–∞—Ñ–∏–∫–∏ –≤–Ω–∏–∑—É –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∏ DAU.*

### –≠–∫—Ä–∞–Ω 2: –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
![Behavior](images/behavior.png)  
*–ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —É—Ä–æ–≤–Ω—é –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, —Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–¥–µ–Ω—å √ó —á–∞—Å), —Ç–æ–ø –ª–æ–∫–∞—Ü–∏–π –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º ‚Äì –∑–¥–µ—Å—å –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è.*

### –≠–∫—Ä–∞–Ω 3: –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å–µ–≥–º–µ–Ω—Ç—ã
![Details](images/details.png)  
*–¢–∞–±–ª–∏—Ü–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–µ–π—Å—Ç–≤–∏–π ‚Äì –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã–µ.*

---

## üîç –ò–Ω—Å–∞–π—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–∞–ª–∏ —ç—Ç–∏ –¥–∞—à–±–æ—Ä–¥—ã

- **–°—Ä–µ–¥–Ω—è—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è** 4.2% ‚Äì —Ç–∏–ø–∏—á–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è e‚Äëcommerce, –Ω–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –≤–∞–∂–Ω—É—é –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å.
- **30% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∫–æ–Ω–≤–µ—Ä—Å–∏–µ–π –≤—ã—à–µ 5% –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç 70% –≤—Å–µ—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤** ‚Äì —á–∏—Å—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ –ü–∞—Ä–µ—Ç–æ.
- **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ 2) –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ç –≤ –¥–≤–∞ —Ä–∞–∑–∞ –ª—É—á—à–µ –¥–µ—Å–∫—Ç–æ–ø–∞ ‚Äì –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É –Ω–∞ –∑–∞–º–µ—Ç–∫—É.
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–æ–ª–µ–µ 30 –¥–Ω–µ–π** —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é –≤ 3 —Ä–∞–∑–∞ ‚Äì –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –Ω—É–∂–Ω–æ –ø–æ–æ—â—Ä—è—Ç—å.
- **–¢–æ–ø‚Äë5 –≥–æ—Ä–æ–¥–æ–≤** –¥–∞—é—Ç 40% –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ ‚Äì —Å –Ω–∏—Ö —Å—Ç–æ–∏—Ç –Ω–∞—á–∏–Ω–∞—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
|------------------|---------------------------------------------|
| Apache Spark     | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö             |
| Jupyter          | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ETL                 |
| PostgreSQL       | –•—Ä–∞–Ω–∏–ª–∏—â–µ core‚Äë—Å–ª–æ—è –∏ –≤–∏—Ç—Ä–∏–Ω                |
| Apache Airflow   | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π           |
| Apache Superset  | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, –¥–∞—à–±–æ—Ä–¥—ã                      |
| MinIO            | S3‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö    |
| Papermill        | –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–æ—É—Ç–±—É–∫–æ–≤ –∏–∑ Airflow |
| psycopg2         | –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å PostgreSQL –∏–∑ Python       |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
avitotech-analytics/
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îú‚îÄ‚îÄ 01_data_ingestion.ipynb          # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ core-—Å–ª–æ–π
‚îÇ   ‚îî‚îÄ‚îÄ 02_build_marts.ipynb              # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –≤–∏—Ç—Ä–∏–Ω
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îî‚îÄ‚îÄ avito_incremental_marts_dag.py    # DAG Airflow
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ create_core_tables.sql            # DDL –¥–ª—è core.fct_user_interactions
‚îÇ   ‚îî‚îÄ‚îÄ create_mart_tables.sql             # DDL –¥–ª—è –≤–∏—Ç—Ä–∏–Ω marts
‚îú‚îÄ‚îÄ superset_dashboards/
‚îÇ   ‚îî‚îÄ‚îÄ user_behavior_dashboard.json       # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–∞ Superset
‚îú‚îÄ‚îÄ images/                                 # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–ª—è README
‚îÇ   ‚îú‚îÄ‚îÄ overview.png
‚îÇ   ‚îú‚îÄ‚îÄ behavior.png
‚îÇ   ‚îî‚îÄ‚îÄ details.png
‚îú‚îÄ‚îÄ requirements.txt                        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md                               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üë§ –ê–≤—Ç–æ—Ä

**–ò–ª—å—è –ü–µ—Ç—Ä–æ–≤** (–ø—Ä–∏–º–µ—Ä)  
Data Engineer —Å –æ–ø—ã—Ç–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –∏ –ª—é–±–æ–≤—å—é –∫ —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.  
–í–µ—Ä—é, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –ø–æ–ª—å–∑—É, –∞ –Ω–µ –ø—ã–ª–∏—Ç—å—Å—è –≤ –æ–∑–µ—Ä–µ.

- üåê [GitHub](https://github.com/yourusername)
- üìß your.email@example.com
- üíº [LinkedIn](https://linkedin.com/in/yourprofile)

---

‚≠ê **–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º ‚Äì –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**  
üìä –í—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç –∫ –æ–±—Å—É–∂–¥–µ–Ω–∏—é –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É.
```
